export class PrefixedStorage {
    prefix;
    storage;
    constructor(prefix, storage) {
        this.prefix = prefix;
        this.storage = storage;
    }
    *keys() {
        const l = this.storage.length;
        const p = `${this.prefix}_`;
        const pl = p.length;
        for (let i = 0; i < l; ++i) {
            const key = this.storage.key(i);
            if (key.substring(0, pl) === p) {
                yield key.substring(pl);
            }
        }
    }
    get length() {
        return Array.from(this.keys()).length;
    }
    clear() {
        const keys = Array.from(this.keys());
        for (const key of keys) {
            this.storage.removeItem(`${this.prefix}_${key}`);
        }
    }
    getItem(key) {
        return this.storage.getItem(`${this.prefix}_${key}`) ?? null;
    }
    key(index) {
        let i = 0;
        for (const key of this.keys()) {
            if (i++ === index) {
                return key;
            }
        }
        return null;
    }
    removeItem(key) {
        this.storage.removeItem(`${this.prefix}_${key}`);
    }
    setItem(key, value) {
        this.storage.setItem(`${this.prefix}_${key}`, value);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJlZml4ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJwcmVmaXhlZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLE9BQU8sZUFBZTtJQUVoQjtJQUNBO0lBRlgsWUFDVyxNQUFjLEVBQ2QsT0FBZ0I7UUFEaEIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLFlBQU8sR0FBUCxPQUFPLENBQVM7SUFDeEIsQ0FBQztJQUVNLENBQUMsSUFBSTtRQUNkLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDO1FBQzlCLE1BQU0sQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDO1FBQzVCLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFDcEIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRTtZQUMzQixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUUsQ0FBQztZQUNqQyxJQUFJLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRTtnQkFDL0IsTUFBTSxHQUFHLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQ3hCO1NBQ0Q7SUFDRixDQUFDO0lBRUQsSUFBSSxNQUFNO1FBQ1QsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQztJQUN2QyxDQUFDO0lBRUQsS0FBSztRQUNKLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDckMsS0FBSyxNQUFNLEdBQUcsSUFBSSxJQUFJLEVBQUU7WUFDdkIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7U0FDakQ7SUFDRixDQUFDO0lBRUQsT0FBTyxDQUFDLEdBQVc7UUFDbEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLElBQUksR0FBRyxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUM7SUFDOUQsQ0FBQztJQUVELEdBQUcsQ0FBQyxLQUFhO1FBQ2hCLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNWLEtBQUssTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFO1lBQzlCLElBQUksQ0FBQyxFQUFFLEtBQUssS0FBSyxFQUFFO2dCQUNsQixPQUFPLEdBQUcsQ0FBQzthQUNYO1NBQ0Q7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNiLENBQUM7SUFFRCxVQUFVLENBQUMsR0FBVztRQUNyQixJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNsRCxDQUFDO0lBRUQsT0FBTyxDQUFDLEdBQVcsRUFBRSxLQUFhO1FBQ2pDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sSUFBSSxHQUFHLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUN0RCxDQUFDO0NBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgUHJlZml4ZWRTdG9yYWdlIGltcGxlbWVudHMgU3RvcmFnZSB7XG5cdHB1YmxpYyBjb25zdHJ1Y3Rvcihcblx0XHRwcm90ZWN0ZWQgcHJlZml4OiBzdHJpbmcsXG5cdFx0cHJvdGVjdGVkIHN0b3JhZ2U6IFN0b3JhZ2UsXG5cdCkge31cblxuXHRwcm90ZWN0ZWQgKmtleXMoKTogR2VuZXJhdG9yPHN0cmluZz4ge1xuXHRcdGNvbnN0IGwgPSB0aGlzLnN0b3JhZ2UubGVuZ3RoO1xuXHRcdGNvbnN0IHAgPSBgJHt0aGlzLnByZWZpeH1fYDtcblx0XHRjb25zdCBwbCA9IHAubGVuZ3RoO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbDsgKytpKSB7XG5cdFx0XHRjb25zdCBrZXkgPSB0aGlzLnN0b3JhZ2Uua2V5KGkpITtcblx0XHRcdGlmIChrZXkuc3Vic3RyaW5nKDAsIHBsKSA9PT0gcCkge1xuXHRcdFx0XHR5aWVsZCBrZXkuc3Vic3RyaW5nKHBsKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIEFycmF5LmZyb20odGhpcy5rZXlzKCkpLmxlbmd0aDtcblx0fVxuXG5cdGNsZWFyKCk6IHZvaWQge1xuXHRcdGNvbnN0IGtleXMgPSBBcnJheS5mcm9tKHRoaXMua2V5cygpKTtcblx0XHRmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG5cdFx0XHR0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShgJHt0aGlzLnByZWZpeH1fJHtrZXl9YCk7XG5cdFx0fVxuXHR9XG5cblx0Z2V0SXRlbShrZXk6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShgJHt0aGlzLnByZWZpeH1fJHtrZXl9YCkgPz8gbnVsbDtcblx0fVxuXG5cdGtleShpbmRleDogbnVtYmVyKTogc3RyaW5nIHwgbnVsbCB7XG5cdFx0bGV0IGkgPSAwO1xuXHRcdGZvciAoY29uc3Qga2V5IG9mIHRoaXMua2V5cygpKSB7XG5cdFx0XHRpZiAoaSsrID09PSBpbmRleCkge1xuXHRcdFx0XHRyZXR1cm4ga2V5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdHJlbW92ZUl0ZW0oa2V5OiBzdHJpbmcpOiB2b2lkIHtcblx0XHR0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShgJHt0aGlzLnByZWZpeH1fJHtrZXl9YCk7XG5cdH1cblxuXHRzZXRJdGVtKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0dGhpcy5zdG9yYWdlLnNldEl0ZW0oYCR7dGhpcy5wcmVmaXh9XyR7a2V5fWAsIHZhbHVlKTtcblx0fVxufVxuIl19
